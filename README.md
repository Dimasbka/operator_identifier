# operator_identifier

Определение оператора и региона по номеру телефона

веб форма находится по адреу
    http://127.0.0.1:8000/

ендпоинт API по адреу
    http://127.0.0.1:8000/v1/api/phone_info



## Структура
project
|   project
|     | project       - папка с настройкими проекта
|     | registry      - модели и вьюшки
|     | downloads     - папка для загрузки csv базы
|   examples          - Примеры работы



# Процесс установки:

## виртуальное окружение  (необязательный шаг)
создать виртуальное окружение и активироать его 
```bash
python -m venv .venv
activate .venv 
или .venv\Scripts\activate.bat для виндовс
```

## установка
```bash
pip install -r requirements.txt
```

## настройка
нужно переименовать файл `project/project/settings_example.py` в `settings.py` 
и указать свои данные для базы

для базы
- `DATABASES`

и если это удалённый сервер, нужно указать хост для корректной работы в `ALLOWED_HOSTS` 

для папки `project/downloads` установить права на чтение и запись - это папка испоьзуется при загрузке базы данных операторов
ну либо указать другую папку настройках, раздел  `REGISTRY['download_dir']` 


Далее можно убедится что все успешно установилось  
```bash
    manage.py check
```

и синхронизировать базу данных
```bash
    manage.py makemigrations
    manage.py migrate
```

создать администратора если планируете пользоваться админкой 
```bash
    manage.py createsuperuser
```


## загрузка данных из реестра номеров 
скачать данные можно запустив команду
```bash
    manage.py registry_update
```
есть защита от одновременных запусков и загрузок в течении дня
при обновлении удалятся все уже существующие данне диапазонов 

запуск тестового сервера
```bash
    manage.py runserver
```
запуск продакшен сервера согласно документации [https://docs.djangoproject.com/en/5.0/howto/deployment/](https://docs.djangoproject.com/en/5.0/howto/deployment/)
например так
```bash
 uvicorn project/asgi:application  --host 127.0.0.1 --reload
```


# Что бы хотелось еще сделать
- добавить тестов для эндпоинтов 
- переделать загрузки данных, используя вспомогательную таблиу для загрузки, и потом перегружать данные в рамках транзакции
- проести оптимизацию запросов добавив индексов 
